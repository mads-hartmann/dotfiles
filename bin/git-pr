#!/usr/bin/env bash

# Simple script to open the Github compare with the current branch
# against $DEFAULT_PR_BRANCH.
#
# If DEFAULT_PR_BRANCH is not set it will use master.
#
# This will most likely break unless you have very simple branch
# names.

DEFAULT_PR_BRANCH=${DEFAULT_PR_BRANCH:-master}

# Make sure we're inside a git repo.
git rev-parse --is-inside-work-tree &>/dev/null

if [[ $? != 0 ]]; then
  echo "Not a git repository." 1>&2
  exit 1
fi

# Open the compare view.
branch=$(git symbolic-ref -q --short HEAD)
open "https://github.com/famly/app/compare/$DEFAULT_PR_BRANCH...$branch?expand=1"
